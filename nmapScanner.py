#!/usr/bin/env python2

try:
   import nmap
except ImportError:
   print 'nmap module not installed.\ntry : apt-get install python-nmap'
   exit()
import optparse

def nmapScan(tgtHost, tgtPort):
    nscan = nmap.PortScanner()
    nscan.scan(tgtHost, tgtPort)
    state = nscan[tgtHost]['tcp'][int(tgtPort)]['state']
    print " [+] " + tgtHost + " tcp/" +tgtPort + " " +state

def main():
    parser = optparse.OptionParser('usage%prog '+ '-H <target host> -p <target port>')
    parser.add_option('-H', dest='tgtHost', type='string', help='specify target host')
    parser.add_option('-p', dest='tgtPort', type='string', help='specify target port[s] seperated by a comma')
    (options, args) = parser.parse_args()
    tgtHost = options.tgtHost
    tgtPorts = str(options.tgtPort).split(', ')
    if (tgtHost == None) | (tgtPorts[0] == None):
       print parser.usage
       exit(0)
    for tgtPort in tgtPorts:
        nmapScan(tgtHost, tgtPort)

if __name__ == '__main__':
   main()
